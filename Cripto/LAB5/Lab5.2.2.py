import random

p = 323170060713110073001535134778251633624880571334890751745884341392698068341362100027920563626401646854585563579353308169288290230805734726252735547424612457410262025279165729728627063003252634282131457669314142236542209411113486299916574782680342305530863490506355557712219187890332729569696961297438562417412362372251973464026918557977679768230146253979330580152268587307611975324364674758554607150438968449403661304976978128542959459670512838213542922925504568272879113720093893187395914337417583782600278034973198552060753323412603254684088120031105907484281003994966956119696956248629032338072839127039

g = 2
x = random.randint(1, p - 1)
y = pow(g, x, p)
message = "Руссу Николай"

k = random.randint(1, p - 1)
c1 = pow(g, k, p)
c2 = [(ord(char) * pow(y, k, p)) % p for char in message]

inv_k = pow(c1, x, p)
decrypted_message = ''.join([chr((char * pow(inv_k, -1, p)) % p) for char in c2])

print("Секретный ключ (x):", x)
print("Открытый ключ (y):", y)
print("Зашифрованное сообщение (c1, c2):", c1, c2)
print("Расшифрованное сообщение:", decrypted_message)
